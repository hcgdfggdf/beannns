<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pos-Sha: The Illuminated Tongue</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;800&family=Manrope:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #f8fafc;
            --accent: #d97706;
        }
        
        html { scroll-behavior: smooth; }

        body {
            font-family: 'Manrope', sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(#cbd5e1 1px, transparent 1px);
            background-size: 32px 32px;
            color: #1e293b;
        }
        .font-ancient { font-family: 'Cinzel', serif; }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.05);
        }
        .input-area { transition: all 0.3s ease; }
        .input-area:focus-within {
            background: white;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.02); 
        }
        
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #cbd5e1; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade { animation: fadeIn 0.5s ease-out forwards; }

        .back-to-top {
            opacity: 0; transform: translateY(20px); pointer-events: none;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .back-to-top.visible { opacity: 1; transform: translateY(0); pointer-events: all; }

        .rotate-180-smooth { transform: rotate(180deg); }

        /* === NEW VOCAB STYLE FOR SUPER BIGGER TERMS === */
        .vocab-term-text {
            font-size: 1.125rem; /* text-lg */
            line-height: 1.75rem; /* leading-7 */
        }
    </style>
</head>
<body id="top" class="min-h-screen flex flex-col items-center py-12 px-4 selection:bg-amber-100 selection:text-amber-900 relative">

    <header class="text-center mb-10 animate-fade w-full max-w-4xl flex flex-col md:flex-row justify-between items-center gap-4 md:gap-0">
        <div class="text-center md:text-left">
            <div class="inline-flex items-center justify-center w-12 h-12 bg-slate-900 text-amber-400 rounded-xl shadow-lg mb-2 text-2xl">
                ðŸ“œ
            </div>
            <h1 class="text-3xl md:text-4xl font-ancient font-bold text-slate-900 tracking-tight">Pos-Sha</h1>
            <p class="text-slate-500 text-xs font-bold tracking-widest uppercase">The Posti, Sharron Language Project </p>
        </div>
        
        <button onclick="document.getElementById('vocab-section').scrollIntoView({behavior: 'smooth'})" 
                class="group flex items-center gap-2 px-5 py-2 bg-white border border-slate-200 rounded-full shadow-sm hover:shadow-md hover:border-amber-200 transition-all">
            <span class="text-xs font-bold text-slate-600 group-hover:text-amber-600 uppercase tracking-wide">Lexicon</span>
            <svg class="w-4 h-4 text-slate-400 group-hover:text-amber-500 transform group-hover:translate-y-0.5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
        </button>
    </header>

    <main class="w-full max-w-4xl space-y-8 animate-fade" style="animation-delay: 0.1s;">
        
        <div class="flex justify-center items-center mb-[-20px] z-10 relative">
            <button id="swap-mode-btn" class="bg-slate-900 hover:bg-amber-500 text-amber-400 hover:text-white p-3 rounded-full shadow-lg transition-all hover:scale-110 active:rotate-180 duration-300 group">
                <svg class="w-5 h-5 transition-transform duration-500" id="swap-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path></svg>
            </button>
        </div>

        <div class="glass-card rounded-3xl overflow-hidden shadow-xl flex flex-col md:flex-row min-h-[400px]">
            
            <div class="flex-1 flex flex-col border-b md:border-b-0 md:border-r border-slate-100 input-area bg-slate-50/50">
                <div class="px-6 py-4 flex justify-between items-center">
                    <span id="input-label" class="text-xs font-bold text-slate-400 uppercase tracking-widest transition-all">English</span>
                    <button id="clear-btn" class="text-slate-300 hover:text-red-400 transition-colors text-xs font-bold uppercase">Purge Text</button>
                </div>
                <textarea 
                    id="input-text" 
                    class="flex-1 w-full bg-transparent border-none focus:ring-0 p-6 text-xl resize-none outline-none text-slate-700 leading-relaxed"
                    placeholder="type here, twin..."
                    spellcheck="false"
                ></textarea>
            </div>

            <div class="flex-1 flex flex-col bg-white/60 relative">
                <div class="px-6 py-4 flex justify-between items-center">
                    <span id="output-label" class="text-xs font-bold text-amber-600 uppercase tracking-widest transition-all">Pos-Sha</span>
                    <div class="flex gap-2">
                        <span class="h-2 w-2 rounded-full bg-red-400"></span>
                        <span class="h-2 w-2 rounded-full bg-amber-400"></span>
                        <span class="h-2 w-2 rounded-full bg-green-400"></span>
                    </div>
                </div>
                <textarea 
                    id="output-text" 
                    readonly
                    class="flex-1 w-full bg-transparent border-none focus:ring-0 p-6 text-xl resize-none outline-none text-slate-800 font-ancient font-medium leading-relaxed"
                    placeholder="..."
                ></textarea>
                
                <div class="absolute bottom-6 right-6">
                    <button id="copy-btn" class="group flex items-center gap-2 bg-slate-900 hover:bg-slate-800 text-white px-5 py-2.5 rounded-full transition-all hover:shadow-lg active:scale-95">
                        <span class="text-sm font-bold">Replicate</span>
                        <svg class="w-4 h-4 text-amber-400 group-hover:rotate-12 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                    </button>
                </div>
            </div>
        </div>

        <div id="vocab-section" class="grid md:grid-cols-3 gap-6 scroll-mt-6" style="animation-delay: 0.2s;">
            
            <div class="glass-card rounded-3xl p-6 md:col-span-3 overflow-hidden flex flex-col">
                <div class="flex justify-between items-baseline mb-4 border-b border-slate-100 pb-2">
                    <h3 class="font-ancient font-bold text-2xl text-slate-800">The Core Lexicon</h3>
                    <span class="text-xs font-bold bg-slate-100 text-slate-500 px-2 py-1 rounded" id="vocab-count"></span>
                </div>
                
                <div class="overflow-y-auto custom-scroll pr-2 max-h-[500px]"> <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm" id="vocab-list">
                        </div>
                </div>
            </div>
        </div>
    </main>

    <button onclick="window.scrollTo({top: 0, behavior: 'smooth'})" id="back-to-top" class="back-to-top fixed bottom-8 right-8 bg-slate-900 text-amber-400 p-3 rounded-full shadow-xl hover:scale-110 transition-transform z-40">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path></svg>
    </button>

    <div id="toast" class="fixed top-6 left-1/2 -translate-x-1/2 bg-slate-900 text-white px-6 py-3 rounded-full shadow-2xl flex items-center gap-3 transition-all duration-300 opacity-0 translate-y-[-20px] z-50">
        <span class="text-amber-400 text-lg">âœ“</span>
        <span class="font-medium text-sm">Replicated to clipboard</span>
    </div>

    <script>
        // Core Dictionaries
        let dictionary = {
            "i": "zu'ral", "me": "zu'ral", "my": "zu'ral", "mine": "zu'ral",
            "you": "na'rul", "your": "na'rul", "yours": "na'rul",
            "he": "si'nur", "him": "si'nur", "his": "si'nur",
            "she": "si'nur", "her": "si'nur", "hers": "si'nur",
            "it": "si'nur", "its": "si'nur",
            "we": "gu'ral", "us": "gu'ral", "our": "gu'ral", "ours": "gu'ral",
            "they": "klurak", "them": "klurak", "their": "klurak", "theirs": "klurak",
            "this": "ha'ru", "that": "vohrak", "these": "ha'ru", "those": "vohrak",
            "friend": "zi'naz", "dog": "ky'ar", "house": "kri'ez", "love": "a'mi",
            "man": "dr'om", "woman": "ny'li", "god": "sha'ron",
            // --- NEW TERMS START ---
            "to be": "shal", "is": "shal", "am": "shal", "are": "shal", 
            "to go": "ve'ra", "go": "ve'ra",
            "to see": "li'da", "see": "li'da",
            "to eat": "m'un", "eat": "m'un",
            "and": "tek",
            "but": "vir",
            "big": "gra'al",
            "small": "ni'ko",
            "yes": "e'ya",
            "no": "na'as"
            // --- NEW TERMS END ---
        };

        let reverseDictionary = {
            "zu'ral": "i/me/my",
            "na'rul": "you/your",
            "si'nur": "he/she/it/him/her/his",
            "gu'ral": "we/us/our",
            "klurak": "they/them/their",
            "ha'ru": "this/these",
            "vohrak": "that/those",
            "zi'naz": "friend",
            "ky'ar": "dog",
            "kri'ez": "house",
            "a'mi": "love",
            "dr'om": "man",
            "ny'li": "woman",
            "sha'ron": "god",
            // --- NEW TERMS START ---
            "shal": "to be/is/am/are",
            "ve'ra": "to go/go",
            "li'da": "to see/see",
            "m'un": "to eat/eat",
            "tek": "and",
            "vir": "but",
            "gra'al": "big",
            "ni'ko": "small",
            "e'ya": "yes",
            "na'as": "no"
            // --- NEW TERMS END ---
        };
        
        let currentMode = 'enToPs'; // 'enToPs' or 'psToEn'

        // --- DOM Elements ---
        const inputText = document.getElementById('input-text');
        const outputText = document.getElementById('output-text');
        const inputLabel = document.getElementById('input-label');
        const outputLabel = document.getElementById('output-label');
        const swapModeBtn = document.getElementById('swap-mode-btn');
        const swapIcon = document.getElementById('swap-icon');
        const clearBtn = document.getElementById('clear-btn');
        const copyBtn = document.getElementById('copy-btn');
        const toast = document.getElementById('toast');
        const backToTopBtn = document.getElementById('back-to-top');
        const vocabList = document.getElementById('vocab-list');
        const vocabCount = document.getElementById('vocab-count');


        // --- Utility Functions ---

        /**
         * Cleans a word by converting to lower case and removing punctuation.
         * @param {string} word 
         * @returns {string} The cleaned word.
         */
        const cleanWord = (word) => {
            // Keep apostrophes (for Pos-Sha terms like zu'ral)
            return word.toLowerCase().replace(/[^a-z0-9']/g, '');
        }

        /**
         * Main translation logic.
         */
        const translate = () => {
            const input = inputText.value;
            if (!input.trim()) {
                outputText.value = '...';
                return;
            }

            const words = input.split(/\s+/);
            const translatedWords = words.map(word => {
                const cleaned = cleanWord(word);
                let translation = '';
                let punctuation = '';

                // Extract any trailing punctuation (e.g., ".", "?", "!")
                const matchPunctuation = word.match(/([^a-zA-Z0-9']+)$/);
                if (matchPunctuation) {
                    punctuation = matchPunctuation[1];
                }

                if (currentMode === 'enToPs') {
                    // English to Pos-Sha translation
                    if (dictionary[cleaned]) {
                        translation = dictionary[cleaned];
                    } else {
                        // NEW LOGIC: If not found, apply pos...ti
                        // Preserve the original cleaned word, but format it
                        translation = `pos${cleaned}ti`; 
                    }
                } else {
                    // Pos-Sha to English translation
                    if (reverseDictionary[cleaned]) {
                        translation = reverseDictionary[cleaned];
                    } else if (cleaned.startsWith('pos') && cleaned.endsWith('ti') && cleaned.length > 5) {
                        // NEW LOGIC: If it looks like a pos...ti word, remove the tags
                        // Example: poswordti -> word
                        translation = cleaned.slice(3, -2);
                    } else {
                        // If not found and not a pos...ti word, just return the word
                        translation = cleaned;
                    }
                }

                // Preserve original casing of the first letter if it was capitalized
                if (word.length > 0 && word[0] === word[0].toUpperCase() && translation.length > 0) {
                    translation = translation.charAt(0).toUpperCase() + translation.slice(1);
                }

                return translation + punctuation;
            });

            outputText.value = translatedWords.join(' ');
        }

        /**
         * Renders the vocabulary list.
         */
        const renderVocab = () => {
            vocabList.innerHTML = '';
            
            // We'll always display English -> Pos-Sha for clarity in the Lexicon section
            const displayDict = dictionary;

            const sortedKeys = Object.keys(displayDict).sort();

            // Filter out redundant keys (like "i", "me", "my" which all map to "zu'ral")
            const uniqueEnglishTerms = new Set();
            const filteredKeys = sortedKeys.filter(key => {
                const translation = displayDict[key];
                // Check if the translation has already been displayed
                if (!uniqueEnglishTerms.has(translation)) {
                    uniqueEnglishTerms.add(translation);
                    return true; // Keep this key as the representative for its translation
                }
                return false; // Skip redundant keys
            });

            filteredKeys.forEach(key => {
                const term = document.createElement('div');
                // Added py-2 for more vertical space between terms
                term.className = 'flex flex-col md:flex-row md:justify-between border-b border-slate-50/50 py-2'; 
                
                // Use the reverse dictionary for the English term to show all forms (e.g., "i/me/my" for zu'ral)
                const englishForms = reverseDictionary[displayDict[key]] || key;

                term.innerHTML = `
                    <span class="vocab-term-text font-bold text-slate-700 w-1/2">${englishForms.charAt(0).toUpperCase() + englishForms.slice(1)}</span>
                    <span class="vocab-term-text font-ancient text-amber-600 w-1/2">${displayDict[key]}</span>
                `;
                vocabList.appendChild(term);
            });
            
            vocabCount.textContent = `${uniqueEnglishTerms.size} terms`; // Count based on unique translations
        }


        // --- Event Handlers ---

        /**
         * Toggles the translation mode (English <-> Pos-Sha).
         */
        const swapMode = () => {
            currentMode = currentMode === 'enToPs' ? 'psToEn' : 'enToPs';
            
            if (currentMode === 'enToPs') {
                inputLabel.textContent = 'English';
                outputLabel.textContent = 'Pos-Sha';
                inputText.placeholder = "type here, twin...";
            } else {
                inputLabel.textContent = 'Pos-Sha';
                outputLabel.textContent = 'English';
                inputText.placeholder = "Pos-Sha text...";
            }

            // Swap text contents
            const tempText = inputText.value;
            inputText.value = outputText.value;
            outputText.value = tempText || '...';
            
            swapIcon.classList.toggle('rotate-180-smooth');
            // renderVocab() is not needed on swap since we fixed it to always show EN->PS for clarity
        }

        /**
         * Clears the input and output areas.
         */
        const clearText = () => {
            inputText.value = '';
            outputText.value = '...';
            inputText.focus();
        }

        /**
         * Copies the output text to the clipboard and shows a toast.
         */
        const copyOutput = () => {
            if (outputText.value && outputText.value !== '...') {
                navigator.clipboard.writeText(outputText.value).then(() => {
                    // Show toast notification
                    toast.classList.add('opacity-100', 'translate-y-0');
                    toast.classList.remove('opacity-0', 'translate-y-[-20px]');
                    setTimeout(() => {
                        toast.classList.remove('opacity-100', 'translate-y-0');
                        toast.classList.add('opacity-0', 'translate-y-[-20px]');
                    }, 2000);
                }).catch(err => {
                    console.error('Could not copy text: ', err);
                });
            }
        }
        
        /**
         * Toggles the back-to-top button visibility.
         */
        const handleScroll = () => {
            if (window.scrollY > 300) {
                backToTopBtn.classList.add('visible');
            } else {
                backToTopBtn.classList.remove('visible');
            }
        }

        // --- Initialization ---

        const init = () => {
            // Event Listeners
            inputText.addEventListener('input', translate);
            swapModeBtn.addEventListener('click', swapMode);
            clearBtn.addEventListener('click', clearText);
            copyBtn.addEventListener('click', copyOutput);
            window.addEventListener('scroll', handleScroll);
            
            // Initial setup
            renderVocab();
        }

        // Run initialization when the page is loaded
        init();
    </script>
</body>
</html>
