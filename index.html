<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pos-Sha: The Illuminated Tongue</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;800&family=Manrope:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #f8fafc;
            --accent: #d97706; /* Amber 600 */
        }
        
        html { scroll-behavior: smooth; }

        body {
            font-family: 'Manrope', sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(#cbd5e1 1px, transparent 1px);
            background-size: 32px 32px;
            color: #1e293b;
        }
        .font-ancient { font-family: 'Cinzel', serif; }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.05);
        }
        .input-area { transition: all 0.3s ease; }
        .input-area:focus-within {
            background: white;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.02); 
        }
        
        /* Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #cbd5e1; }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade { animation: fadeIn 0.5s ease-out forwards; }

        .back-to-top {
            opacity: 0; transform: translateY(20px); pointer-events: none;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .back-to-top.visible { opacity: 1; transform: translateY(0); pointer-events: all; }

        /* Swap Button Animation */
        .rotate-180-smooth { transform: rotate(180deg); }
    </style>
</head>
<body id="top" class="min-h-screen flex flex-col items-center py-12 px-4 selection:bg-amber-100 selection:text-amber-900 relative">

    <header class="text-center mb-10 animate-fade w-full max-w-4xl flex flex-col md:flex-row justify-between items-center gap-4 md:gap-0">
        <div class="text-center md:text-left">
            <div class="inline-flex items-center justify-center w-12 h-12 bg-slate-900 text-amber-400 rounded-xl shadow-lg mb-2 text-2xl">
                ðŸ“œ
            </div>
            <h1 class="text-3xl md:text-4xl font-ancient font-bold text-slate-900 tracking-tight">Pos-Sha</h1>
            <p class="text-slate-500 text-xs font-bold tracking-widest uppercase">The Posti, Sharron Language Project </p>
        </div>
        
        <button onclick="document.getElementById('vocab-section').scrollIntoView({behavior: 'smooth'})" 
                class="group flex items-center gap-2 px-5 py-2 bg-white border border-slate-200 rounded-full shadow-sm hover:shadow-md hover:border-amber-200 transition-all">
            <span class="text-xs font-bold text-slate-600 group-hover:text-amber-600 uppercase tracking-wide">Vocab</span>
            <svg class="w-4 h-4 text-slate-400 group-hover:text-amber-500 transform group-hover:translate-y-0.5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
        </button>
    </header>

    <main class="w-full max-w-4xl space-y-8 animate-fade" style="animation-delay: 0.1s;">
        
        <div class="flex justify-center items-center mb-[-20px] z-10 relative">
            <button id="swap-mode-btn" class="bg-slate-900 hover:bg-amber-500 text-amber-400 hover:text-white p-3 rounded-full shadow-lg transition-all hover:scale-110 active:rotate-180 duration-300 group">
                <svg class="w-5 h-5 transition-transform duration-500" id="swap-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path></svg>
            </button>
        </div>

        <div class="glass-card rounded-3xl overflow-hidden shadow-xl flex flex-col md:flex-row min-h-[400px]">
            
            <div class="flex-1 flex flex-col border-b md:border-b-0 md:border-r border-slate-100 input-area bg-slate-50/50">
                <div class="px-6 py-4 flex justify-between items-center">
                    <span id="input-label" class="text-xs font-bold text-slate-400 uppercase tracking-widest transition-all">English</span>
                    <button id="clear-btn" class="text-slate-300 hover:text-red-400 transition-colors text-xs font-bold uppercase">Purge Text</button>
                </div>
                <textarea 
                    id="input-text" 
                    class="flex-1 w-full bg-transparent border-none focus:ring-0 p-6 text-xl resize-none placeholder-slate-300 outline-none text-slate-700 leading-relaxed"
                    placeholder="type here, twin..."
                    spellcheck="false"
                ></textarea>
            </div>

            <div class="flex-1 flex flex-col bg-white/60 relative">
                <div class="px-6 py-4 flex justify-between items-center">
                    <span id="output-label" class="text-xs font-bold text-amber-600 uppercase tracking-widest transition-all">Pos-Sha</span>
                    <div class="flex gap-2">
                        <span class="h-2 w-2 rounded-full bg-red-400"></span>
                        <span class="h-2 w-2 rounded-full bg-amber-400"></span>
                        <span class="h-2 w-2 rounded-full bg-green-400"></span>
                    </div>
                </div>
                <textarea 
                    id="output-text" 
                    readonly
                    class="flex-1 w-full bg-transparent border-none focus:ring-0 p-6 text-xl resize-none outline-none text-slate-800 font-ancient font-medium leading-relaxed"
                    placeholder="..."
                ></textarea>
                
                <div class="absolute bottom-6 right-6">
                    <button id="copy-btn" class="group flex items-center gap-2 bg-slate-900 hover:bg-slate-800 text-white px-5 py-2.5 rounded-full transition-all hover:shadow-lg active:scale-95">
                        <span class="text-sm font-bold">Replicate</span>
                        <svg class="w-4 h-4 text-amber-400 group-hover:rotate-12 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                    </button>
                </div>
            </div>
        </div>

        <div id="vocab-section" class="grid md:grid-cols-3 gap-6 scroll-mt-6" style="animation-delay: 0.2s;">
            
            <div class="glass-card rounded-3xl p-6 md:col-span-1 flex flex-col justify-center">
                <h3 class="font-ancient font-bold text-lg text-slate-800 mb-1">Architect ðŸ§±</h3>
                <p class="text-xs text-slate-400 mb-4">Fabricate novel Pos-Sha terminology.</p>
                
                <div class="space-y-3">
                    <input type="text" id="forge-input" placeholder="Root (e.g. Illuminate)" class="w-full bg-slate-100 border-none rounded-xl px-4 py-2 text-sm focus:ring-2 focus:ring-amber-400 outline-none transition-shadow">
                    <div class="relative">
                        <select id="forge-type" class="w-full appearance-none bg-slate-100 border-none rounded-xl px-4 py-2 text-sm focus:ring-2 focus:ring-amber-400 outline-none text-slate-600 transition-shadow cursor-pointer">
                            <option value="noun">Noun [-iz]</option>
                            <option value="verb">Verb [-ek]</option>
                            <option value="adj">Adjective [-vum]</option>
                            <option value="other">Other [-ril]</option>
                        </select>
                        <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-4 text-slate-500">
                            <svg class="fill-current h-4 w-4" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                        </div>
                    </div>
                    <button id="forge-btn" class="w-full bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 rounded-xl transition-colors text-sm shadow-md hover:shadow-lg active:scale-95">Construct Term</button>
                    <div id="forge-result" class="text-center hidden pt-2">
                        <span class="font-ancient text-lg text-slate-800 animate-pulse" id="forge-output"></span>
                    </div>
                </div>
            </div>

            <div class="glass-card rounded-3xl p-6 md:col-span-2 overflow-hidden flex flex-col h-64 md:h-auto">
                <div class="flex justify-between items-baseline mb-4 border-b border-slate-100 pb-2">
                    <h3 class="font-ancient font-bold text-lg text-slate-800">The Core Lexicon</h3>
                    <span class="text-xs font-bold bg-slate-100 text-slate-500 px-2 py-1 rounded">Unknown pos...ti</span>
                </div>
                
                <div class="overflow-y-auto custom-scroll pr-2">
                    <div class="grid grid-cols-2 gap-2 text-sm" id="vocab-list">
                        </div>
                </div>
            </div>
        </div>
    </main>

    <button onclick="window.scrollTo({top: 0, behavior: 'smooth'})" id="back-to-top" class="back-to-top fixed bottom-8 right-8 bg-slate-900 text-amber-400 p-3 rounded-full shadow-xl hover:scale-110 transition-transform z-40">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path></svg>
    </button>

    <div id="toast" class="fixed top-6 left-1/2 -translate-x-1/2 bg-slate-900 text-white px-6 py-3 rounded-full shadow-2xl flex items-center gap-3 transition-all duration-300 opacity-0 translate-y-[-20px] z-50">
        <span class="text-amber-400 text-lg">âœ“</span>
        <span class="font-medium text-sm">Replicated to clipboard</span>
    </div>

    <script>
        // --- DATA ---
        // NEW SUFFIXES: -iz (Noun), -ek (Verb), -vum (Adjective/Adverb), -ril (Pronoun/Particle)
        // **NEW, ORIGINAL, NON-CLASSICAL ROOTS**

        const dictionary = {
            // --- PRONOUNS & ARTICLES (-ril) ---
            "i": "zaril", "me": "zaril", "my": "zaril", "mine": "zaril",
            "you": "naril", "your": "naril", "yours": "naril",
            "he": "synril", "him": "synril", "his": "synril",
            "she": "synril", "her": "synril", "hers": "synril",
            "it": "synril", "its": "synril",
            "we": "goril", "us": "goril", "our": "goril", "ours": "goril",
            "they": "kloril", "them": "kloril", "their": "kloril", "theirs": "kloril",
            "this": "harril", "that": "vohrÄ±l", "these": "harril", "those": "vohrÄ±l",
            "who": "vecril", "what": "thiril", "where": "lyaril",
            "the": "toril", "a": "aril", "an": "aril",
            "some": "fecril", "many": "gluril", "much": "gluril",
            "one": "solril", "two": "duril", "three": "trogil",

            // --- COMMON NOUNS (-iz) ---
            "friend": "ziniz", "homie": "ziniz", "buddy": "ziniz", "twin": "ziniz",
            "cat": "mriz", "kitty": "mriz",
            "dog": "kyariz", "dawg": "kyariz", "pup": "kyariz",
            "house": "kriez", "home": "kriez", "crib": "kriez", "building": "kriez",
            "sun": "syrfiz", "star": "yliz", "moon": "kriziz",
            "man": "dromiz", "dude": "dromiz", "guy": "dromiz",
            "boy": "veniz", "son": "veniz",
            "food": "azliz", "grub": "azliz", "meal": "azliz",
            "river": "skimiz", "ocean": "valiz", "sea": "valiz",
            "tree": "faliz", "water": "syriz", "air": "vyrriz", "fire": "fyriz", "earth": "soliz",
            "time": "chroniz", "day": "loriz", "night": "noxiz", "life": "shaviz",
            "death": "moriz", "name": "namiz", "place": "triz",
            "work": "erghiz", "money": "kleniz", "cash": "kleniz",
            "city": "uruz", "problem": "glumiz", "thing": "kosiz",
            "mind": "psykoriz", "heart": "kariz", "body": "somiz",
            "magic": "shariniz", "god": "sharron", // CUSTOM EXPLICIT TRANSLATION
            "woman": "nyliz", "girl": "nyliz", "lady": "nyliz", 
            "love": "amiz", "affection": "amiz",
            "queen": "regiz", "idea": "ethriz", "thought": "ethriz",

            // --- VERBS (INFINITIVE: -ek) ---
            "is": "vekek", "am": "vekek", "are": "vekek", "be": "vekek", "was": "vekek", "were": "vekek",
            "eat": "azzek", "ate": "azzek", "to eat": "azzek",
            "see": "vidlek", "saw": "vidlek", "to see": "vidlek",
            "go": "bavvek", "went": "bavvek", "to go": "bavvek",
            "like": "filtek", "loved": "filtek", "to like": "filtek",
            "speak": "lorrek", "say": "lorrek", "said": "lorrek", "to speak": "lorrek",
            "jump": "salek", "to jump": "salek",
            "run": "kurrek", "to run": "kurrek",
            "fight": "pughek", "to fight": "pughek",
            "do": "fyznek", "make": "fyznek", "did": "fyznek",
            "come": "vennek", "came": "vennek",
            "take": "kaprek", "took": "kaprek",
            "give": "donnek", "gave": "donnek",
            "walk": "trultek", "sleep": "hypnek",
            "know": "skylek", "understand": "skylek",
            "want": "vynnek", "need": "vynnek",
            "help": "julvek", "assist": "julvek",
            "think": "kogtek", "thought": "kogtek",
            "play": "ludek", "game": "ludek",

            // --- ADJECTIVES & ADVERBS (-vum) ---
            "big": "blevum", "huge": "blevum", "large": "blevum",
            "small": "sylevum", "lil": "sylevum", "tiny": "sylevum",
            "good": "fyruvum", "great": "fyruvum", "well": "fyruvum",
            "bad": "kyllavum", "evil": "kyllavum", "poorly": "kyllavum",
            "happy": "elavum", "joyful": "elavum",
            "sad": "lunevum", "unhappy": "lunevum",
            "fast": "trakvum", "quickly": "trakvum",
            "slow": "bradovum", "slowly": "bradovum",
            "old": "vetovum", "new": "narvum",
            "hot": "terluvum", "cold": "kryovum",
            "full": "plenavum", "empty": "vakrevum",
            "strong": "potovum", "weak": "impovum",
            "beautiful": "belovum", "ugly": "turvum",

            // --- CONJUNCTIONS & PREPOSITIONS (-ril) ---
            "no": "naril", "not": "naril", "nah": "naril",
            "yes": "yarril", "yeah": "yarril", "yep": "yarril",
            "all": "gluril", "everything": "gluril",
            "and": "enril", "but": "sydril", "or": "velril",
            "for": "prolril", "on": "syrril", "in": "inril", "with": "kumeril",
            "of": "deryl", "from": "deryl", "to": "adrel",
            "because": "quilaril", "if": "syril", "when": "quandoril",
            "how": "quomol",

            // --- GREETINGS & SLANG ---
            "hello": "salvum", "hi": "salvum", "yo": "salvum",
            "bye": "valril", "peace": "paxril",
            "let's": "goril", 
            "dope": "fyruvum", "lit": "fyruvum"
        };

        const phrases = {
            "my bad": "zaril kyllavum",
            "let's go": "goril bavvek",
            "it's all good": "synril gluril fyruvum",
            "all good": "gluril fyruvum",
            "i love you": "zaril filtek naril",
            "i know": "zaril skylek",
            "peace out": "valril paxril"
        };

        // Pronoun lookup table for Pos-Sha to English translation
        const pronounCases = {
            "zaril": { subject: "I", object: "me", possessive: "my" },
            "naril": { subject: "you", object: "you", possessive: "your" },
            "synril": { subject: "he", object: "him", possessive: "his" }, 
            "goril": { subject: "we", object: "us", possessive: "our" },
            "kloril": { subject: "they", object: "them", possessive: "their" },
            "toril": { subject: "the", object: "the", possessive: "the" },
            "aril": { subject: "a", object: "a", possessive: "a" },
            "harril": { subject: "this", object: "this", possessive: "this" },
            "vohrÄ±l": { subject: "that", object: "that", possessive: "that" }
        };

        // List of words that are usually followed by a possessive (Nouns ending in -iz)
        const possessiveWords = [
            "ziniz", "mriz", "kyariz", "kriez", "syrfiz", "yliz", "kriziz", "dromiz", "veniz",
            "azliz", "skimiz", "valiz", "faliz", "syriz", "vyrriz", "fyriz", "soliz",
            "chroniz", "loriz", "noxiz", "shaviz", "moriz", "namiz", "triz",
            "erghiz", "kleniz", "uruz", "glumiz", "kosiz",
            "psykoriz", "kariz", "somiz", "shariniz", "sharron", // Include custom 'sharron'
            "nyliz", "amiz", "regiz", "ethriz"
        ];

        // List of Verbs (ending in -ek)
        const verbWords = [
            "vekek", "azzek", "vidlek", "bavvek", "filtek", "lorrek",
            "salek", "kurrek", "pughek", "fyznek", "vennek", "kaprek",
            "donnek", "trultek", "hypnek", "skylek", "vynnek", "julvek",
            "kogtek", "ludek"
        ];
        
        // Generate Reverse Dictionary (Pos-Sha -> English)
        const reverseDictionary = {};
        for (const [eng, pos] of Object.entries(dictionary)) {
            if (!pronounCases[pos]) {
                const currentRoot = reverseDictionary[pos];
                // Simple check for primary word
                if (!currentRoot || eng.length < currentRoot.length) {
                    reverseDictionary[pos] = eng;
                }
            }
        }
        
        // Explicitly set some common or key roots for clarity in Pos-Sha -> English
        reverseDictionary["nyliz"] = "woman"; 
        reverseDictionary["veniz"] = "boy";
        reverseDictionary["amiz"] = "love";
        reverseDictionary["kriez"] = "house";
        reverseDictionary["skylek"] = "know"; 
        reverseDictionary["fyznek"] = "do"; 


        // --- DOM ELEMENTS ---
        const inputs = {
            main: document.getElementById('input-text'),
            output: document.getElementById('output-text'),
            clear: document.getElementById('clear-btn'),
            copy: document.getElementById('copy-btn'),
            swapBtn: document.getElementById('swap-mode-btn'),
            swapIcon: document.getElementById('swap-icon'),
            inputLabel: document.getElementById('input-label'),
            outputLabel: document.getElementById('output-label'),
            forgeRoot: document.getElementById('forge-input'),
            forgeType: document.getElementById('forge-type'),
            forgeBtn: document.getElementById('forge-btn'),
            forgeRes: document.getElementById('forge-result'),
            forgeOut: document.getElementById('forge-output'),
            vocabList: document.getElementById('vocab-list'),
            backToTop: document.getElementById('back-to-top')
        };

        // --- STATE ---
        let isEnglishToPosSha = true;

        // --- INIT VOCAB UI ---
        // Expanded starter pack for the UI using the NEW words
        const starterPack = {
            "I/Me/My": "zaril", "You/Your": "naril", "He/She/It": "synril", "We/Us": "goril",
            "The/A": "toril/aril", "Friend/Homie": "ziniz", "Dog/Dawg": "kyariz", "House/Home": "kriez",
            "Love": "amiz", "Food": "azliz", "Time": "chroniz", "Sharron (God)": "sharron",
            "To Be": "vekek", "To Eat": "azzek", "To Go": "bavvek", "To Know": "skylek", "Big": "blevum",
            "Small": "sylevum", "Good": "fyruvum", "Bad": "kyllavum", "No/Not": "naril", 
            "Yes": "yarril", "Hello": "salvum", "And": "enril", "With": "kumeril"
        };

        // Clear existing list and populate with the expanded starter pack
        inputs.vocabList.innerHTML = '';
        for (const [eng, eos] of Object.entries(starterPack)) {
            const div = document.createElement('div');
            div.className = "flex justify-between border-b border-slate-100 py-1.5 hover:bg-slate-50 px-1 rounded transition-colors";
            div.innerHTML = `<span class="text-slate-500">${eng}</span> <span class="font-medium text-amber-600 font-ancient">${eos}</span>`;
            inputs.vocabList.appendChild(div);
        }

        // --- TRANSLATION ENGINES (NO CHANGES TO LOGIC, ONLY DICTIONARY) ---
        
        // 1. Eng -> Pos 
        function translateToPosSha(text) {
            if (!text.trim()) return "";
            let processedText = text.toLowerCase();
            
            // Phrases (Handle multi-word phrases first)
            for (const [phrase, translation] of Object.entries(phrases)) {
                processedText = processedText.replace(new RegExp(`\\b${phrase}\\b`, 'gi'), translation);
            }

            // Tokenize by splitting words, spaces, and punctuation
            const tokens = processedText.match(/(\w+['â€™]?\w*|[^\w\s]|\s+)/g) || [];
            
            let translatedTokens = tokens.map(token => {
                if (/^[\s\p{P}]+$/u.test(token)) return token; 
                
                const cleanWord = token.toLowerCase();
                
                // Check dictionary for exact match 
                if (dictionary[cleanWord]) return dictionary[cleanWord];
                
                // Handle plurals (simple -s pluralization check)
                if (cleanWord.endsWith('s')) {
                    const singular = cleanWord.slice(0, -1);
                    if (dictionary[singular]) return dictionary[singular];
                }
                
                // Default: Unknown word wrapper
                return `pos${cleanWord}ti`;
            });

            return formatCase(translatedTokens.join(''));
        }

        // 2. Pos -> Eng (Contextual lookup)
        function translateToEnglish(text) {
            if (!text.trim()) return "";
            
            const wordsOnly = text.match(/\b\w+\b/g) || [];
            const rawTokens = text.match(/(\w+|[^\w\s]|\s+)/g) || [];
            let translatedTokens = [];

            const findWordIndexInWordsOnly = (wordOnlyIndex, step) => {
                let index = wordOnlyIndex + step;
                return (index >= 0 && index < wordsOnly.length) ? index : null;
            };

            let wordOnlyIndex = 0; 

            for (let i = 0; i < rawTokens.length; i++) {
                let token = rawTokens[i];
                let cleanWord = token.toLowerCase();

                if (/\w+/.test(token)) {
                    
                    // --- 1. Handle invariant pronouns (contextual cases) ---
                    if (pronounCases[cleanWord]) {
                        let pronounData = pronounCases[cleanWord];
                        let englishWord = pronounData.subject; 

                        const nextWordOnlyIndex = findWordIndexInWordsOnly(wordOnlyIndex, 1);
                        const prevWordOnlyIndex = findWordIndexInWordsOnly(wordOnlyIndex, -1);
                        
                        const nextWord = nextWordOnlyIndex !== null ? wordsOnly[nextWordOnlyIndex].toLowerCase() : null;
                        const prevWord = prevWordOnlyIndex !== null ? wordsOnly[prevWordOnlyIndex].toLowerCase() : null;
                        
                        // Rule 1: Possessive Case (followed by a possessable noun: ending in -iz or the custom 'sharron')
                        if (nextWord && possessiveWords.includes(nextWord)) {
                            englishWord = pronounData.possessive;
                        
                        // Rule 2: Objective Case (preceded by a verb: ending in -ek)
                        } else if (prevWord && verbWords.includes(prevWord) && cleanWord !== wordsOnly[0].toLowerCase()) {
                            englishWord = pronounData.object;
                        } 
                        
                        translatedTokens.push(englishWord);
                        wordOnlyIndex++; 
                        continue;
                    
                    // --- 2. Handle all other mapped words (nouns, verbs, adjectives, conjunctions) ---
                    } else if (reverseDictionary[cleanWord]) {
                        translatedTokens.push(reverseDictionary[cleanWord]);
                        wordOnlyIndex++;
                        continue;
                    } else if (cleanWord === "sharron") {
                        translatedTokens.push("god");
                        wordOnlyIndex++;
                        continue;
                    }

                    // --- 3. Check for pos...ti (Unknown word wrapper) ---
                    const posTiMatch = cleanWord.match(/^pos(.+)ti$/);
                    if (posTiMatch) {
                        translatedTokens.push(posTiMatch[1]); // Return the inner word
                        wordOnlyIndex++;
                        continue;
                    }

                    // If it's a word but not in any list, just push the original token
                    translatedTokens.push(token);
                    wordOnlyIndex++;
                
                } else {
                    // 4. Keep original token (punctuation, spaces)
                    translatedTokens.push(token);
                }
            }

            return formatCase(translatedTokens.join(''));
        }

        // Helper for sentence case
        function formatCase(str) {
            return str.replace(/(?:^|[.!?]\s+)([a-z])/g, (c) => c.toUpperCase());
        }

        // Master Function
        function processTranslation() {
            const text = inputs.main.value;
            if (isEnglishToPosSha) {
                inputs.output.value = translateToPosSha(text);
            } else {
                inputs.output.value = translateToEnglish(text);
            }
        }

        // --- EVENTS (No logic change needed, just updating 'Copy' text) ---
        inputs.main.addEventListener('input', processTranslation);

        inputs.clear.addEventListener('click', () => {
            inputs.main.value = '';
            inputs.output.value = '';
            inputs.main.focus();
        });

        inputs.swapBtn.addEventListener('click', () => {
            isEnglishToPosSha = !isEnglishToPosSha;
            
            inputs.swapIcon.classList.toggle('rotate-180-smooth');
            
            if (isEnglishToPosSha) {
                inputs.inputLabel.textContent = "English";
                inputs.inputLabel.className = "text-xs font-bold text-slate-400 uppercase tracking-widest transition-all";
                inputs.outputLabel.textContent = "Pos-Sha";
                inputs.outputLabel.className = "text-xs font-bold text-amber-600 uppercase tracking-widest transition-all";
                inputs.main.placeholder = "Articulate your discourse here, twin...";
            } else {
                inputs.inputLabel.textContent = "Pos-Sha";
                inputs.inputLabel.className = "text-xs font-bold text-amber-600 uppercase tracking-widest transition-all";
                inputs.outputLabel.textContent = "English";
                inputs.outputLabel.className = "text-xs font-bold text-slate-400 uppercase tracking-widest transition-all";
                inputs.main.placeholder = "Input Pos-Sha text (e.g. zaril)...";
            }

            const currentIn = inputs.main.value;
            const currentOut = inputs.output.value;
            
            inputs.main.value = currentOut;
            inputs.output.value = currentIn;
            
            processTranslation();
        });

        inputs.copy.addEventListener('click', () => {
            if (!inputs.output.value) return;
            inputs.output.select();
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(inputs.output.value);
            } else {
                document.execCommand('copy');
            }

            const toast = document.getElementById('toast');
            const copyText = isEnglishToPosSha ? "Pos-Sha Replicated" : "English Replicated";
            toast.querySelector('span:last-child').textContent = copyText;

            toast.classList.remove('opacity-0', 'translate-y-[-20px]');
            setTimeout(() => toast.classList.add('opacity-0', 'translate-y-[-20px]'), 2000);
        });

        inputs.forgeBtn.addEventListener('click', () => {
            const root = inputs.forgeRoot.value.trim().toLowerCase();
            if (!root) return;
            let suffix = "";
            switch(inputs.forgeType.value) {
                case 'noun': suffix = "iz"; break;
                case 'verb': suffix = "ek"; break;
                case 'adj': suffix = "vum"; break; 
                case 'other': suffix = "ril"; break;
            }
            const cleanRoot = root.replace(/[^a-z0-9]/g, ''); 
            
            inputs.forgeOut.textContent = cleanRoot + suffix;
            inputs.forgeRes.classList.remove('hidden');
        });

        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) inputs.backToTop.classList.add('visible');
            else inputs.backToTop.classList.remove('visible');
        });

        window.addEventListener('load', () => {
            inputs.main.focus();
            inputs.main.placeholder = "Type here, twin...";
        });

    </script>
</body>
</html>
